Think of yourself, currently working as a Business analyst in one of the top sports company. The senior management team has asked you to come up with metrics with which they can gauge which team will win the upcoming La Liga cup (Football tournament).

The data set contains information on all the teams so far participated in all the past tournaments. It has data about how many goals each team scored, conceded, how many times they came within first 6 positions, how many seasons they have qualified, their best position in the past etc.

 

You are required to do the following:

1 Read the data set and replace dashes with 0 to make sure you can perform arithmetic operations on the data

2 Print all the teams which have started playing between 1930-1980

3 Print the list of teams which came Top 5 in terms of points

4 Write a function with name “Goal_diff_count” which should return all the teams with their Goal Differences. Using the same function, find the team which has maximum and minimum goal difference
Goal_diff_count = GoalsFor - GoalsAgainst

5 Create a new column with name “Winning Percent” and append it to the data set
Percentage of Winning = (GamesWon / GamesPlayed)*100
If there are any numerical error, replace it with 0%
Print the top 5 teams which has the highest Winning percentage

6 Group teams based on their “Best position” and print the sum of the points for all "Best positions"
Eg: Best Position                Points

        1                              27933

        2                              6904

1 Read the data set and replace dashes with 0 to make sure you can perform arithmetic operations on the data.

import pandas as pd
df = pd.read_csv("Laliga.csv")
df.head(10)

df = df.replace("-",0)
df

2 Print all the teams which have started playing between 1930-1980.

df1 = df[df.Debut.between(str(1930),str(1980))]
df1

for i,j in zip(df.Team, df.Debut):
    if(j>='1930' and j<='1980'):
        print(i, "-", j)

3 Print the list of teams which came Top 5 in terms of points.

df['Points'] = df['Points'].astype(int)
df.nlargest(5, ['Points'])

4 Write a function with name “Goal_diff_count” which should return all the teams with their Goal Differences. Using the same function, find the team which has maximum and minimum goal difference.
Goal_diff_count = GoalsFor - GoalsAgainst

df.index = df.Team
df.GoalsFor = df.GoalsFor.astype(int)
df.GoalsAgainst = df.GoalsAgainst.astype(int)

def Goal_diff_count(a,b):
    Goal_diff_count = a-b
    return Goal_diff_count
Goal_diff_count(df.GoalsFor, df.GoalsAgainst)

max(Goal_diff_count(df.GoalsFor, df.GoalsAgainst))

min(Goal_diff_count(df.GoalsFor, df.GoalsAgainst))

5 Create a new column with name “Winning Percent” and append it to the data set
Percentage of Winning = (GamesWon / GamesPlayed)*100
Print the top 5 teams which has the highest Winning percentage

df.GamesWon = df.GamesWon.astype(int)
df.GamesPlayed = df.GamesPlayed.astype(int)
GamesWon = df.loc[:,'GamesWon']
GamesPlayed = df.loc[:,'GamesPlayed']
df['Winning Percent'] = (GamesWon / GamesPlayed)*100
df['Winning Percent'] = df['Winning Percent'].fillna(0)
df

df.nlargest(5, ['Winning Percent'])

6 Group teams based on their “Best position” and print the sum of the points for all "Best positions"

df1 = df.groupby(['BestPosition']).Points.sum()
df1.rename_axis('BestPosition Points')
